/* Global Theme Tokens & Utilities --------------------------------------------------
   Provides a cohesive, elegant visual system for the Stone Management UI.
   - Design tokens (colors, spacing, typography, radii, shadows)
   - Light/Dark mode (auto & manual) via .theme-dark on <body>
   - Utility classes for layout, flex, grid, spacing, text, surface & components
   - Motion helpers while respecting reduced motion preferences
----------------------------------------------------------------------------------- */

/* CSS Reset (modern minimal) */
* { box-sizing: border-box; }
html { -webkit-text-size-adjust: 100%; }
body, h1, h2, h3, h4, h5, h6, p, figure, blockquote { margin: 0; }
ul[role='list'], ol[role='list'] { list-style: none; margin: 0; padding: 0; }
img, picture, svg, video, canvas { display: block; max-width: 100%; }
button { font: inherit; }
input, button, textarea, select { font: inherit; }

/* Root Tokens */
:root {
  /* Colors */
  --color-bg: #f6f9fc;
  --color-bg-alt: #ffffff;
  --color-surface: #ffffff;
  --color-surface-alt: #f1f5fb;
  --color-border: #e2e8f0;
  --color-border-strong: #cbd5e1;
  --color-text: #0f172a;
  --color-text-muted: #64748b;
  --color-primary: #2563eb;
  --color-primary-accent: #3b82f6;
  --color-primary-soft: #dbeafe;
  --color-danger: #dc2626;
  --color-danger-soft: #fee2e2;
  --color-success: #059669;
  --color-success-soft: #d1fae5;
  --gradient-accent: linear-gradient(90deg, var(--color-primary) 0%, var(--color-primary-accent) 100%);

  /* Radii */
  --radius-xs: 4px;
  --radius-sm: 6px;
  --radius-md: 10px;
  --radius-lg: 16px;
  --radius-pill: 999px;

  /* Spacing Scale (4px baseline) */
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --space-4: 16px;
  --space-5: 20px;
  --space-6: 24px;
  --space-8: 32px;
  --space-10: 40px;
  --space-12: 48px;
  --space-16: 64px;

  /* Typography */
  --font-family-sans: 'Inter', 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', Arial, sans-serif;
  --font-size-xs: 0.75rem;
  --font-size-sm: 0.875rem;
  --font-size-base: 1rem;
  --font-size-md: 1.125rem;
  --font-size-lg: 1.25rem;
  --font-size-xl: 1.5rem;
  --font-size-2xl: 1.875rem;
  --line-height-base: 1.5;

  /* Shadows */
  --shadow-xs: 0 1px 2px rgba(0,0,0,0.06);
  --shadow-sm: 0 2px 4px rgba(0,0,0,0.08);
  --shadow-md: 0 4px 12px rgba(0,0,0,0.08);
  --shadow-lg: 0 8px 24px rgba(15,23,42,0.12);
  --shadow-focus: 0 0 0 4px rgba(37,99,235,0.25);

  /* Motion */
  --ease-standard: cubic-bezier(.2,.9,.3,1);
  --ease-emph: cubic-bezier(.16,1,.3,1);
  --dur-fast: 120ms;
  --dur-med: 240ms;
  --dur-slow: 420ms;
}

/* Large Text Accessibility Mode */
body.text-large {
  --font-size-xs: 0.85rem;
  --font-size-sm: 1rem;
  --font-size-base: 1.125rem;
  --font-size-md: 1.25rem;
  --font-size-lg: 1.4rem;
  --font-size-xl: 1.7rem;
  --font-size-2xl: 2.05rem;
}
body.text-large .brand-link { font-size: var(--font-size-lg); }
body.text-large .field label { font-size: var(--font-size-base); }
body.text-large .field input, body.text-large .field select { font-size: var(--font-size-base); padding:1.05rem 1.1rem 0.75rem; }
body.text-large .btn { font-size: var(--font-size-base); padding:0.75rem 1.15rem; }
body.text-large .table-row, body.text-large .table-head { font-size: var(--font-size-sm); }
body.text-large .badge { font-size: var(--font-size-sm); }

/* Dark Theme Override */
body.theme-dark {
  --color-bg: #0f1623;
  --color-bg-alt: #111c2b;
  --color-surface: #152232;
  --color-surface-alt: #1d2b3b;
  --color-border: #243445;
  --color-border-strong: #32495f;
  --color-text: #f1f5f9;
  --color-text-muted: #94a3b8;
  --color-primary: #3b82f6;
  --color-primary-accent: #60a5fa;
  --color-primary-soft: #1e3a8a;
  --color-danger: #f87171;
  --color-danger-soft: #7f1d1d;
  --color-success: #10b981;
  --color-success-soft: #064e3b;
  --gradient-accent: linear-gradient(90deg, var(--color-primary) 0%, var(--color-primary-accent) 100%);
  color-scheme: dark;
}

/* Base Body */
body {
  font-family: var(--font-family-sans);
  background: var(--color-bg);
  color: var(--color-text);
  line-height: var(--line-height-base);
  -webkit-font-smoothing: antialiased;
}

/* Scrollbar (WebKit) */
body::-webkit-scrollbar { width: 12px; }
body::-webkit-scrollbar-track { background: var(--color-bg); }
body::-webkit-scrollbar-thumb { background: var(--color-border); border-radius: var(--radius-pill); }
body::-webkit-scrollbar-thumb:hover { background: var(--color-border-strong); }

/* Utilities --------------------------------------------------------- */
.container { width: 100%; max-width: 1280px; margin: 0 auto; padding: 0 var(--space-4); }
.grid { display: grid; gap: var(--space-4); }
.types-grid { display:grid; gap:0.65rem; grid-template-columns:repeat(2,minmax(0,1fr)); }
@media (max-width:600px){ .types-grid { grid-template-columns:1fr; } }
.form-grid { display:grid; gap:var(--space-4); grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); }
.form-cols { display:grid; gap:var(--space-5); grid-template-columns:1fr 1fr; align-items:start; }
@media (max-width:860px){ .form-cols { grid-template-columns:1fr; } }
.flex { display: flex; }
.flex-center { display: flex; align-items: center; justify-content: center; }
.justify-between { justify-content: space-between; }
.items-center { align-items: center; }
.gap-2 { gap: var(--space-2); }
.gap-3 { gap: var(--space-3); }
.gap-4 { gap: var(--space-4); }
.mt-4 { margin-top: var(--space-4); }
.mb-4 { margin-bottom: var(--space-4); }
.pt-4 { padding-top: var(--space-4); }
.pb-4 { padding-bottom: var(--space-4); }

/* Typography helpers */
.text-muted { color: var(--color-text-muted); }
.text-sm { font-size: var(--font-size-sm); }
.text-xs { font-size: var(--font-size-xs); }
.text-info-lg { font-size: 0.92rem; line-height:1.4; }
.heading { font-weight: 600; letter-spacing: -0.5px; }

/* Card */
.card { background: var(--color-surface); border: 1px solid var(--color-border); border-radius: var(--radius-lg); padding: var(--space-5); box-shadow: var(--shadow-sm); position: relative; }
.card.soft { background: var(--color-surface-alt); }
.card.hoverable { transition: transform var(--dur-med) var(--ease-standard), box-shadow var(--dur-med) var(--ease-standard); }
.card.hoverable:hover { transform: translateY(-3px); box-shadow: var(--shadow-lg); }

/* Buttons */
.btn { --btn-bg: var(--color-primary); --btn-color: #fff; --btn-shadow: var(--shadow-sm); cursor: pointer; border: none; font-weight: 600; font-size: var(--font-size-sm); padding: 0.65rem 1.05rem; border-radius: var(--radius-md); background: var(--btn-bg); color: var(--btn-color); display: inline-flex; align-items: center; gap: 0.5rem; position: relative; transition: background var(--dur-fast) var(--ease-standard), transform var(--dur-fast) var(--ease-standard), box-shadow var(--dur-fast) var(--ease-standard); text-decoration:none; }
.btn:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); }
.btn:active { transform: translateY(0); box-shadow: var(--shadow-xs); }
.btn-outline { --btn-bg: transparent; --btn-color: var(--color-text); border: 1px solid var(--color-border); box-shadow: none; }
.btn-outline:hover { background: var(--color-surface-alt); }
.btn-ghost { --btn-bg: transparent; --btn-color: var(--color-primary); box-shadow: none; border: 1px solid rgba(37,99,235,0.3); }
.btn-ghost:hover { background: var(--color-primary-soft); color: #fff; }
.btn-danger { --btn-bg: var(--color-danger); }
.btn-danger:hover { filter: brightness(1.05); }
.btn-danger-soft { --btn-bg: var(--color-danger-soft); --btn-color: var(--color-danger); border:1px solid var(--color-danger); }
.btn-danger-soft:hover { background: var(--color-danger); color:#fff; }
.btn-add { --btn-bg: linear-gradient(135deg,var(--color-primary) 0%, var(--color-primary-accent) 60%, #4f46e5 100%); --btn-color:#fff; position:relative; overflow:hidden; }
.btn-add::after { content:""; position:absolute; inset:0; background:radial-gradient(circle at 30% 30%, rgba(255,255,255,0.35), transparent 70%); opacity:0; transition:opacity var(--dur-fast) var(--ease-standard); }
.btn-add:hover::after { opacity:0.35; }
.btn-add:hover { box-shadow:0 6px 18px rgba(59,130,246,0.35); transform:translateY(-3px); }
.btn-add:active { transform:translateY(0); box-shadow:var(--shadow-sm); }
.btn-pill { border-radius: var(--radius-pill); }
.btn.disabled, .btn:disabled { opacity: 0.55; cursor: not-allowed; transform: none; box-shadow: none; }

/* Floating Label Input Component */
.field { position: relative; display: flex; flex-direction: column; }
.field.floating { padding-top: 0.6rem; }
.field input, .field select { width: 100%; border: 1px solid var(--color-border); border-radius: var(--radius-md); background: var(--color-surface); padding: 0.95rem 1rem 0.6rem; font-size: var(--font-size-sm); color: var(--color-text); transition: border-color var(--dur-fast) var(--ease-standard), box-shadow var(--dur-fast) var(--ease-standard), transform var(--dur-fast) var(--ease-standard); }
.field input:focus, .field select:focus { outline: none; border-color: var(--color-primary); box-shadow: var(--shadow-focus); transform: translateY(-2px); }
.field label { position: absolute; left: 1rem; top: 1.05rem; font-size: var(--font-size-sm); color: var(--color-text-muted); pointer-events: none; transition: transform var(--dur-fast) var(--ease-standard), color var(--dur-fast) var(--ease-standard), font-size var(--dur-fast) var(--ease-standard); }
.field.floating input:not(:placeholder-shown) + label,
.field.floating input:focus + label,
.field.floating select:focus + label,
.field.floating select:not([value=""]) + label { transform: translateY(-0.7rem) scale(0.85); color: var(--color-primary); }
.field-label { display:block; font-size: var(--font-size-sm); font-weight:600; color: var(--color-text-muted); margin:0 0 0.4rem 0; }

/* Badge */
.badge { display: inline-flex; align-items: center; font-weight: 600; font-size: var(--font-size-xs); padding: 0.3rem 0.7rem; background: var(--color-surface-alt); color: var(--color-text); border-radius: var(--radius-pill); gap: 0.35rem; }
.badge.primary { background: var(--gradient-accent); color: #fff; }
.badge.soft { background: var(--color-primary-soft); color: var(--color-primary); }
.badge.danger { background: var(--color-danger-soft); color: var(--color-danger); }

/* Divider */
.divider { height: 1px; width: 100%; background: var(--color-border); margin: var(--space-4) 0; }

/* Table (responsive grid style) */
.table-grid { display: grid; gap: var(--space-2); }
.table-row, .table-head { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 0.5fr; gap: var(--space-3); align-items: center; background: var(--color-surface); padding: var(--space-3) var(--space-4); border-radius: var(--radius-sm); border: 1px solid var(--color-border); font-size: var(--font-size-xs); }
.table-head { font-weight: 600; background: var(--color-surface-alt); }
.table-row:hover { box-shadow: var(--shadow-sm); }

/* Responsive two-column detail layout */
.details-two-col { display:grid; grid-template-columns:1fr 320px; gap:1.25rem; }
@media (max-width:900px){ .details-two-col { grid-template-columns:1fr; } }

/* Horizontal scroll wrapper for wide tables */
.table-scroll { overflow-x:auto; -webkit-overflow-scrolling:touch; }
.table-scroll::-webkit-scrollbar { height:10px; }
.table-scroll::-webkit-scrollbar-track { background: var(--color-surface-alt); }
.table-scroll::-webkit-scrollbar-thumb { background: var(--color-border); border-radius: var(--radius-pill); }

/* Custom Select (Stone Types) */
.select-type { appearance: none; -webkit-appearance:none; -moz-appearance:none; position:relative; background: linear-gradient(180deg,var(--color-surface) 0%, var(--color-surface-alt) 100%); border:1px solid var(--color-border); padding:0.55rem 2.2rem 0.55rem 0.75rem; font-size: var(--font-size-xs); border-radius: var(--radius-sm); line-height:1.2; color: var(--color-text); cursor:pointer; transition: border-color var(--dur-fast) var(--ease-standard), box-shadow var(--dur-fast) var(--ease-standard), background var(--dur-fast) var(--ease-standard); }
.select-type:hover { background: linear-gradient(180deg,var(--color-surface-alt) 0%, var(--color-surface) 100%); }
.select-type:focus { outline:none; border-color: var(--color-primary); box-shadow: var(--shadow-focus); }
.select-type.invalid { border-color: var(--color-danger); background: var(--color-danger-soft); color: var(--color-danger); }
/* Add a custom dropdown arrow */
.select-type { background-image: url("data:image/svg+xml,%3Csvg width='16' height='16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M4.47 6.47a.75.75 0 011.06 0L8 8.94l2.47-2.47a.75.75 0 111.06 1.06l-3 3a.75.75 0 01-1.06 0l-3-3a.75.75 0 010-1.06z' fill='%2364748b'/%3E%3C/svg%3E"); background-repeat:no-repeat; background-position: right 0.55rem center; background-size:16px 16px; }
body.theme-dark .select-type { background-image: url("data:image/svg+xml,%3Csvg width='16' height='16' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M4.47 6.47a.75.75 0 011.06 0L8 8.94l2.47-2.47a.75.75 0 111.06 1.06l-3 3a.75.75 0 01-1.06 0l-3-3a.75.75 0 010-1.06z' fill='%2394a3b8'/%3E%3C/svg%3E"); }
body.theme-dark .select-type.invalid { background: var(--color-danger-soft); }

/* Snackbar / Toast */
.toast { position: fixed; left: 50%; bottom: var(--space-6); transform: translateX(-50%); background: var(--color-success-soft); color: var(--color-success); padding: 0.65rem 1rem; border-radius: var(--radius-pill); border: 1px solid var(--color-success); font-weight: 600; box-shadow: var(--shadow-md); animation: toastIn var(--dur-med) var(--ease-standard) both; }
@keyframes toastIn { from { opacity: 0; transform: translate(-50%, 12px);} to { opacity: 1; transform: translate(-50%,0);} }

/* Status Segmented Control */
.segment-group { display: flex; flex-wrap: wrap; gap: var(--space-2); background: var(--color-surface-alt); padding: var(--space-2); border-radius: var(--radius-lg); border: 1px solid var(--color-border); }
.segment-group.wrap { flex-wrap: wrap; }
.segment { position: relative; cursor: pointer; padding: 0.4rem 0.75rem; font-size: var(--font-size-xs); font-weight: 600; color: var(--color-text-muted); border-radius: var(--radius-md); transition: background var(--dur-fast) var(--ease-standard), color var(--dur-fast) var(--ease-standard), transform var(--dur-fast) var(--ease-standard); }
.segment input { display: none; }
.segment.active { background: var(--gradient-accent); color: #fff; box-shadow: var(--shadow-sm); }
.segment:hover { transform: translateY(-2px); color: var(--color-text); }
.segment:focus { outline: 3px solid rgba(59,130,246,0.35); outline-offset: 2px; }

/* Animations helpers */
@keyframes fadeUp { from { opacity:0; transform: translateY(24px);} to { opacity:1; transform: translateY(0);} }
.animate-fadeUp { animation: fadeUp var(--dur-slow) var(--ease-standard); }

/* Respect Reduced Motion */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after { animation-duration: 1ms !important; animation-iteration-count: 1 !important; transition-duration: 1ms !important; scroll-behavior: auto !important; }
}

/* Dark mode subtle adjustments */
body.theme-dark .card { box-shadow: 0 4px 14px rgba(0,0,0,0.4); }
body.theme-dark .table-row, body.theme-dark .table-head { background: var(--color-surface-alt); }
body.theme-dark .segment-group { background: var(--color-surface); }

/* Utility for visually hidden (accessibility) */
.sr-only { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0; }

/* Layout Shell */
.app-header-bar { position:sticky; top:0; z-index:50; background:var(--color-bg-alt); border-bottom:1px solid var(--color-border); backdrop-filter: blur(8px) saturate(140%); }
.app-header-inner { display:flex; align-items:center; justify-content:space-between; min-height:64px; }
.brand-link { font-size: var(--font-size-md); font-weight:700; color: var(--color-text); text-decoration:none; letter-spacing:-0.5px; display:inline-flex; align-items:center; gap:0.5rem; }
.brand-link:hover { color: var(--color-primary); }
.route-indicator { font-size: var(--font-size-xs); padding:0.35rem 0.65rem; background: var(--color-surface-alt); border-radius: var(--radius-pill); margin-left:0.75rem; color: var(--color-text-muted); }
.app-main { padding-top: var(--space-6); padding-bottom: var(--space-12); }
.theme-toggle { min-width:96px; }

@media (max-width:760px){
  .app-header-inner { flex-wrap:wrap; gap:var(--space-3); padding-top:var(--space-2); padding-bottom:var(--space-2); }
  .app-main { padding-top: var(--space-4); }
  .route-indicator { display:none; }
}

/* Detail View Layout */
.details-view { max-width:1000px; margin:2.5rem auto; min-height:82vh; padding-top:1.5rem; padding-bottom:2.5rem; display:flex; flex-direction:column; justify-content:flex-start; }
@media (max-width:860px){ .details-view { margin:1.5rem auto; min-height:78vh; padding-top:1rem; padding-bottom:2rem; } }

/* Simple Modal */
.modal-overlay { position:fixed; inset:0; background:rgba(15,23,42,0.55); backdrop-filter: blur(4px); display:flex; align-items:center; justify-content:center; z-index:200; padding:1rem; }
.modal-confirm { width:100%; max-width:420px; background:var(--color-surface); border:1px solid var(--color-border); border-radius:var(--radius-lg); box-shadow:var(--shadow-lg); padding:1.5rem 1.25rem 1.25rem; display:grid; gap:1rem; animation: fadeUp var(--dur-med) var(--ease-standard); }
.modal-confirm h4 { margin:0; font-size:1.05rem; }
.modal-actions { display:flex; justify-content:flex-end; gap:0.75rem; flex-wrap:wrap; }

/* Brand logo */
.brand-logo { width:34px; height:34px; display:block; object-fit:contain; filter:drop-shadow(0 2px 4px rgba(0,0,0,0.3)); }
@media (max-width:600px){ .brand-logo { width:28px; height:28px; } }

/* Brand typography */
.brand-word { font-family:'Playfair Display', serif; font-weight:700; letter-spacing:0.1em; font-size:1.15rem; display:inline-block; line-height:1; }
.brand-gradient { background:linear-gradient(90deg,#f9d976,#f39f86); -webkit-background-clip:text; background-clip:text; color:transparent; text-shadow:0 2px 4px rgba(0,0,0,0.15); }
@media (min-width:800px){ .brand-word { font-size:2.25rem; } }

/* Mobile Utilities */
@media (max-width:600px){
  .btn { padding:0.6rem 0.85rem; font-size: var(--font-size-xs); }
  .card { padding: var(--space-4); }
  .stack-sm { display:flex; flex-direction:column; gap:0.6rem; }
  .hide-xs { display:none !important; }
  .show-xs { display:block !important; }
}
@media (min-width:601px){ .show-xs { display:none !important; } }

/* Sticky action bar for forms on mobile */
.form-actions-sticky { position:sticky; bottom:0; background:var(--color-bg-alt); padding:0.75rem 0; display:flex; justify-content:flex-end; gap:0.6rem; border-top:1px solid var(--color-border); backdrop-filter:blur(10px) saturate(140%); }
@media (min-width:601px){ .form-actions-sticky { position:static; background:transparent; padding:0; border-top:none; backdrop-filter:none; } }
